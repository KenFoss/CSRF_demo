<!-- Below is an example HTML page with JavaScript code that retrieves all cookies from the browser using document.cookie: -->

<!-- html -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Get Cookies</title>
</head>
<body>
    <script>
        window.addEventListener('load', () => {
          fetch('http://localhost:8090/post-example', {
                method: 'POST',
                credentials:"include",
                body: "data"
            })
            .then(response => {
                // Handle the response
                console.log(response.status);
            })
            .catch(error => {
                // Handle any errors
                console.error(error);
            });

            let csrfToken='';

            // cookies return as a string, we need to filter for the desired token
            let cookieList = document.cookie.split('; ')
            cookieList = cookieList.filter( (x) => x.split('=')[0] == 'XSRF-TOKEN')
            // set the token for use in post requests
            if(cookieList.length != 0) {
              csrfToken = cookieList[0].split('=')[1]
            }

            fetch('http://localhost:8090/post-example', {
                method: 'POST',
                headers: {
                    'X-XSRF-Token': csrfToken,
                },
                credentials:"include",
                body: "data"
            })
            .then(response => {
                // Handle the response
                console.log(response.status);
            })
            .catch(error => {
                // Handle any errors
                console.error(error);
            });
        });
    </script>
</body>
</html>
